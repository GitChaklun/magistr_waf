# modsec/modsecurity-override.conf
# Це підхоплюється образом після основних CRS-правил.

# ---- Path Traversal / LFI (../, /etc/passwd, …)
SecRule REQUEST_URI|ARGS "(?:\.\./|\.\.\\|/etc/passwd|/proc/self/environ|/etc/shadow)" \
    "id:100100,\
     phase:2,\
     block,\
     t:none,\
     log,\
     msg:'Custom LFI/Traversal signature hit'"

# ---- Command Injection (;, &&, |, backticks) з небезпечними токенами
SecRule ARGS|REQUEST_HEADERS "(?:;|\|\||&&|\|)\s*(?:id|ls|cat|bash|sh|nc|curl|wget)" \
    "id:100110,\
     phase:2,\
     block,\
     t:none,\
     log,\
     msg:'Custom command injection token(s) in request'"

# (за потреби додай винятки / негативні умовні фільтри тут)
