# ---- QUICK HARDENING ----
SecRuleEngine On

# Піднімаємо параною CRS і пороги блокування
SecAction "id:900000,phase:1,pass,nolog,setvar:tx.paranoia_level=2"
SecAction "id:900110,phase:1,pass,nolog,\
  setvar:tx.inbound_anomaly_score_threshold=5,\
  setvar:tx.outbound_anomaly_score_threshold=4"

# Короткі сигнатури (доповнюють CRS)
SecRule REQUEST_URI|ARGS "(?i)(\bselect\b|\bunion\b|\bor\s+1=1\b|\bsleep\()" \
  "id:100001,phase:2,deny,status:403,log,msg:'Quick SQLi time/union'"

SecRule ARGS "(?i)(<script|onerror=|onload=)" \
  "id:100002,phase:2,deny,status:403,log,msg:'Quick XSS'"

SecRule REQUEST_URI "@beginsWith /admin/user/" \
  "id:100003,phase:1,deny,status:403,log,msg:'Block admin/user/* (impersonate guard)'" 

SecRule ARGS:file|ARGS:download "@rx \.\./" \
  "id:100004,phase:2,deny,status:403,log,msg:'Path traversal in file param'"
